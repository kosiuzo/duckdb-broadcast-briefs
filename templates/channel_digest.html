<!DOCTYPE html>
<html>
<head>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif; max-width: 600px; margin: 0 auto; padding: 20px; line-height: 1.6; color: #333; }
        h1 { color: #007bff; border-bottom: 3px solid #007bff; padding-bottom: 15px; margin-bottom: 30px; font-size: 28px; }
        .metadata { background: #f8f9fa; padding: 12px 15px; border-left: 4px solid #007bff; margin-bottom: 20px; border-radius: 4px; font-size: 14px; color: #666; }
        .episode { background: #ffffff; padding: 20px; margin-bottom: 20px; border: 1px solid #e9ecef; border-radius: 6px; }
        .episode h3 { margin-top: 0; color: #007bff; font-size: 18px; margin-bottom: 10px; }
        .episode-meta { font-size: 13px; color: #999; margin-bottom: 12px; }
        .summary { color: #555; line-height: 1.7; margin-bottom: 12px; }
        .links { margin-top: 15px; padding-top: 12px; border-top: 1px solid #eee; }
        .links a { display: inline-block; margin-right: 15px; color: #007bff; text-decoration: none; font-size: 14px; padding: 6px 12px; background: #f0f7ff; border-radius: 3px; transition: all 0.2s; }
        .links a:hover { background: #007bff; color: white; }
        .episode-count { background: #e7f3ff; color: #0056b3; padding: 12px 15px; border-radius: 4px; margin-bottom: 20px; font-weight: 500; }
        footer { margin-top: 40px; border-top: 1px solid #e9ecef; padding-top: 20px; font-size: 12px; color: #999; text-align: center; }
        .no-episodes { background: #fff3cd; border: 1px solid #ffeaa7; border-radius: 4px; padding: 15px; color: #856404; text-align: center; }
    </style>
</head>
<body>
    <h1>{{ channel_name }}</h1>

    <div class="metadata">
        <strong>Weekly Digest</strong> â€¢ {{ start_date }} to {{ end_date }}
    </div>

    {% if episode_count > 0 %}
    <div class="episode-count">
        ðŸ“º {{ episode_count }} episode{{ 's' if episode_count != 1 else '' }} this week
    </div>

    {% for episode in episodes %}
    <div class="episode">
        <h3>{{ episode.title }}</h3>
        <div class="episode-meta">
            ðŸ“… {{ episode.published_at.strftime('%B %d, %Y') if episode.published_at else 'Date unknown' }}
        </div>
        {% if episode.summary_html %}
        <div class="summary">{{ episode.summary_html|safe }}</div>
        {% else %}
        <div class="summary"><em>Summary not yet available</em></div>
        {% endif %}
        <div class="links">
            <a href="{{ episode.url }}">ðŸŽ¥ Watch on YouTube</a>
            {% if episode.transcript_path %}
            <a href="{{ episode.transcript_path }}">ðŸ“„ Transcript</a>
            {% endif %}
        </div>
    </div>
    {% endfor %}

    {% else %}
    <div class="no-episodes">
        <p>No new episodes from {{ channel_name }} this week</p>
    </div>
    {% endif %}

    <footer>
        <p>This digest was automatically generated by <strong>DuckDB Broadcast Briefs</strong></p>
        <p style="font-size: 11px; margin-top: 10px;">You're receiving this email because you're subscribed to {{ channel_name }} updates</p>
    </footer>
</body>
</html>
